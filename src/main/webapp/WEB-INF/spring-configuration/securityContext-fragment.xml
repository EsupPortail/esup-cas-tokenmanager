  <sec:http auto-config="true" entry-point-ref="casProcessingFilterEntryPoint" pattern="/tokenManager/**" use-expressions="true" xmlns:sec="http://www.springframework.org/schema/security">
    <sec:logout logout-url="/logout.html" logout-success-url="/loggedOut.html"/>
    <sec:custom-filter ref="casProcessingFilter" after="CAS_FILTER"/>
    <sec:intercept-url access="isAuthenticated()" pattern="/tokenManager"/>
    <sec:intercept-url access="isFullyAuthenticated() and hasRole('ROLE_ADMIN')" pattern="/tokenManager/admin"/>
  </sec:http>

  <sec:authentication-manager alias="casAuthenticationManager" xmlns:sec="http://www.springframework.org/schema/security">
    <sec:authentication-provider ref="casAuthenticationProvider"/>
  </sec:authentication-manager>

  <sec:user-service id="userDetailsService" xmlns:sec="http://www.springframework.org/schema/security">
      <sec:user name="${cas.securityContext.serviceProperties.adminUser}" password="notused" authorities="${cas.securityContext.serviceProperties.adminRoles}" />
  </sec:user-service>