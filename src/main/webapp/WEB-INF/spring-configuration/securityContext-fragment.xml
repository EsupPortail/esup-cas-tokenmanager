  <sec:http auto-config="true" entry-point-ref="casProcessingFilterEntryPoint" pattern="/tokenManager/**" use-expressions="true">
    <sec:logout logout-url="/logout.html" logout-success-url="/loggedOut.html"/>
    <sec:custom-filter ref="casProcessingFilter" after="CAS_FILTER"/>
    <sec:intercept-url access="isAuthenticated()" pattern="/tokenManager"/>
    <sec:intercept-url access="isFullyAuthenticated() and hasRole('ROLE_ADMIN')" pattern="/tokenManager/admin"/>
  </sec:http>

  <sec:authentication-manager alias="casAuthenticationManager">
    <sec:authentication-provider ref="casAuthenticationProvider"/>
  </sec:authentication-manager>

  <bean id="serviceProperties" class="org.springframework.security.cas.ServiceProperties"
      p:service="${cas.securityContext.serviceProperties.service}"
      p:sendRenew="false"/>

  <bean id="casProcessingFilter" class="org.springframework.security.cas.web.CasAuthenticationFilter"
        p:authenticationManager-ref="casAuthenticationManager"
        p:filterProcessesUrl="/tokenManager/j_acegi_cas_security_check">
    <property name="authenticationSuccessHandler">
      <bean class="org.springframework.security.web.authentication.SavedRequestAwareAuthenticationSuccessHandler"
            p:alwaysUseDefaultTargetUrl="false"
            p:defaultTargetUrl="/tokenManager"/>
    </property>
    <property name="authenticationFailureHandler">
      <bean class="org.springframework.security.web.authentication.SimpleUrlAuthenticationFailureHandler">
        <constructor-arg index="0" value="/authorizationFailure.html"/>
      </bean>
    </property>
  </bean>

  <bean id="casProcessingFilterEntryPoint" class="org.springframework.security.cas.web.CasAuthenticationEntryPoint"
        p:loginUrl="${cas.securityContext.casProcessingFilterEntryPoint.loginUrl}"
        p:serviceProperties-ref="serviceProperties"/>

  <bean id="casAuthenticationProvider" class="org.springframework.security.cas.authentication.CasAuthenticationProvider"
        p:key="my_password_for_this_auth_provider_only"
        p:serviceProperties-ref="serviceProperties"
        p:userDetailsService-ref="userDetailsService">
    <property name="ticketValidator">
      <bean class="org.jasig.cas.client.validation.Cas20ServiceTicketValidator">
        <constructor-arg index="0" value="${cas.securityContext.ticketValidator.casServerUrlPrefix}"/>
      </bean>
    </property>
  </bean>

  <sec:user-service id="userDetailsService">
      <sec:user name="@CHANGE_THIS@" password="notused" authorities="ROLE_ADMIN" />
  </sec:user-service>